<!-- <!DOCTYPE html> -->
<html>
  <head>
    <title>Donut Shop Homework</title>
  </head>
  <style>

    * {
      font-family: Arial;
    }

    body {
      background-color: #add8e6;
    }

    h1 {
      text-align: center;
    }

    h2 {
      text-align: center;
    }

    p {
      width: 800px;
      margin: auto auto;
    }

    button {
      height: 35px;
      width: 50px;
      border-width: 2px;
      border-radius: 5px;
      background-color: white;
      font-size: 14px;
      font-weight: bold;
      margin-top: 0px;
      margin-left: 15px;
      display: block;
    }

    img {
      height: 100;
      width: auto;
      margin: auto;
      display: block;
      border-radius: 15px;

    }

    #dvTable {
      width: 300;
      margin: 10px auto 10px auto;
    }

    .buttons {
      margin-top: 25px;
      width: 200px;
      text-align: center;
    }

    .button1 {
      width: 75px;
      margin: 10px auto 10px auto;

    }

  </style>
  <body>
    <header>

      <h1>Donut Shop Simulator</h1>

      <img src="https://dl.dropboxusercontent.com/u/69636/homer.jpg" />
      <h2>Customer and Sales Data Table</h2>

      <p>This table displays data from a randomly generated day based on the minimum and maximum customers each location receives per day, the average number of donuts each customer buys and the daily hours of operation</p>
    </header>

    <div id="dvTable"></div>

    <p class="buttons">Click the button below to utilize the Manager object and generate a report that cycles through each locations current donuts per hour and donuts per day</p>

    <div class="button1">
      <button onclick="managerBob.generateReport()">Click</button>
    </div>

    <p class="buttons">Click the button below to utilize the Manager object and add a new shop to a list of the current shop and display their location and hours.  Note:  this does not affect the rest of the simulation.</p>

    <div class="button1">
      <button onclick="managerBob.addShop()">Click</button>
    </div>

    <p class="buttons">Click the button below and enter a shop location to get simulation info on the random numbers generated</p>

    <div class="button1">
      <button onclick="displayData()">Click</button>
    </div>

    <p class="buttons">Click the button below to utilize the Manager object and to change the average number of donuts per customer for a specific store </p>

    <div class="button1">
      <button onclick="managerBob.changeDonutAverage()">Click</button>
    </div>

    <script>

      // donut shop constuctor
      function Shop(location, minCustomer, maxCustomer, donutAverage, hoursOpen) {

        this.location = location;
        this.minCustomer = minCustomer;
        this.maxCustomer = maxCustomer;
        this.donutAverage = donutAverage;
        this.hoursOpen = hoursOpen;

        this.ranCustArray = [];
        this.donutsHourArray = [];
        this.donutsPerDay = 0;

        //random customer per hour open generator
        for (i = 0; i < this.hoursOpen; i++) {
          var randomNumber = (Math.floor(Math.random() * (this.maxCustomer - this.minCustomer +1)) + this.minCustomer);
          this.ranCustArray[i] = randomNumber;
        }

        //find the number of donuts needed per hour, rounded up
        for (i = 0; i < this.ranCustArray.length; i++) {
          var hourly = Math.ceil(this.ranCustArray[i] * this.donutAverage);
          this.donutsHourArray[i] = hourly;
        }

        //find the total donuts needed in the randomly generated day
        for (i = 0; i < this.donutsHourArray.length; i++) {
          this.donutsPerDay += this.donutsHourArray[i];
        }

        /* find the average number of donuts needed per hour for that day,
        rounded up to nearest full donut */
        this.hourlyAverage = Math.ceil(this.donutsPerDay / this.hoursOpen);

        //method to return the average donuts per hour
        this.getDonutsPerHour = function () {
          return this.hourlyAverage;
        };

        //method to return the total donuts for the day
        this.getDonutsPerDay = function () {
          return this.donutsPerDay;
        };
      }

      //shop manager object constructor
      function DonutMaster(name) {

        //establish the name of the new manager (object)
        var managerName = name;

        //function to display shop name, donuts per hour and donuts per day
        this.generateReport = function () {
          for (i = 0; i < printArray.length; i++) {
            alert(printArray[i].location + " Donuts per hour: " + printArray[i].getDonutsPerHour() + "    Donuts per day: " + printArray[i].getDonutsPerDay());
          };
        }

        //method to add a new shop to the current list of shops and their parameters.  This is LOCAL ONLY, does not change values in the rest of the script
        this.addShop = function(){

          //create a new local array to be eddited
          var addShopArray = new Array();
          for (i = 0; i < printArray.length; i++) {
            addShopArray.push([printArray[i].location, printArray[i].hoursOpen]);
          }

          //get parameters for the new shop and add them to the array
          var newShopName = prompt("Enter a name or location for the new shop");
          var newShopDaily = prompt("Enter a number value for the hours per day the shop is open");

          addShopArray.push([newShopName, newShopDaily]);

          //loop through the array and display the values, including the new shop
          for (i = 0; i < addShopArray.length; i++) {
            alert("Shop name and hours open: " + addShopArray[i]);
          }

        };

        //method to change average donuts per customer
        this.changeDonutAverage = function () {

          var shopLocation = prompt("Please enter the name of the shop you would like to change the average donuts per customer");

          var newAverage = prompt("Please enter the new average donuts per customer");

          //change location string to lower case and remove spaces
          shopLocation = shopLocation.toLowerCase();
          shopLocation = shopLocation.replace(/\s+/g, '');

          //check to make sure newAverage is a number and then change from string to number
          if (isNaN(newAverage)) {
            alert("Invalid entry for the new average, try again");
          } else {
            newAverage = Number(newAverage);
          }

          //switch statement to set the new donut average for the selected shop
          switch(shopLocation) {

          case "downtown":
            downtown.donutAverage = newAverage;
            break;

          case "capitolhill":
            capitolhill.donutAverage = newAverage;
            break;

          case "southlakeunion":
            southlakeunion.donutAverage = newAverage;
            break;

          case "wedgewood":
            wedgewood.donutAverage = newAverage;
            break;

          case "ballard":
            ballard.donutAverage = newAverage;
            break;

          default:
            alert("Error");

          }

          //I'm getting the respective donutAverage's to update, however recalling the generate table function is not showing the update in the table.
          GenerateTable();

        };

      }

      //create shop opbjects
      var downtown = new Shop("Downtown", 8, 43, 4.5, 24);
      var capitolhill = new Shop("Capitol Hill", 4, 37, 2, 10);
      var southlakeunion = new Shop("South Lake Union", 9, 23, 6.33, 8);
      var wedgewood = new Shop("Wedgewood", 2, 28, 1.25, 10);
      var ballard = new Shop("Ballard", 8, 58, 3.75, 10);
      var printArray = [downtown, capitolhill, southlakeunion, wedgewood, ballard];

      //create manager object
      var managerBob = new DonutMaster("Bob");

      //function call to generate table of data on the page
      GenerateTable();

      //display detailed information to the console
      for (i = 0; i < printArray.length; i++) {

        console.log(printArray[i].location);

        console.log("For the randomly generated day, the " + printArray[i].location + " store, which is open " + printArray[i].hoursOpen + " hours per day, had the following customers per hour: " + printArray[i].ranCustArray);

        console.log("The corresponding donuts per hour needed (rounded up) given the average of " + printArray[i].donutAverage + " donuts per customer, for the " + printArray[i].location + " store, therefore would be as follows: " + printArray[i].donutsHourArray);

        console.log("Given these numbers, the total number of donuts needed for this day would be " + printArray[i].donutsPerDay + " at an average of " + printArray[i].hourlyAverage + " donuts an hour (rounded up).");
      }

      //function to display data in a table. For some reason it's currently not displaying the data for Ballard
      function GenerateTable() {

        // Create an array for the table data and add column headers
        var donutTable = new Array();
        donutTable.push(["Location", "Hours Open", "Donuts /Hour", "Donuts /Day"]);

        //populate the donut table with data
        for (i = 0; i < donutTable[0].length; i++) {
          var tempArray = [printArray[i].location, printArray[i].hoursOpen, printArray[i].hourlyAverage, printArray[i].donutsPerDay];
          donutTable.push(tempArray);
        }

        //create HTML table element
        var table = document.createElement ("TABLE");
        table.border = "1";

        //get number of columns
        var columnCount = donutTable[0].length;

        //Add the header row.
        var row = table.insertRow(-1);
        for (var i = 0; i < columnCount; i++) {
          var headerCell = document.createElement("TH");
          headerCell.innerHTML = donutTable[0][i];
          row.appendChild(headerCell);
        }

        //Add the data rows.
        for (var i = 1; i < donutTable.length; i++) {
          row = table.insertRow(-1);
          for (var j = 0; j < columnCount; j++) {
            var cell = row.insertCell(-1);
            cell.innerHTML = donutTable[i][j];
          }
        }

        //insert the table into the HTML
        var dvTable = document.getElementById("dvTable");
        dvTable.innerHTML = "";
        dvTable.appendChild(table);

      }

      //function to display all the data from the simulation.
      function displayData () {

        //switch statement to find specific data by location name
        switch(prompt("Enter a location name to get detailed data.").toLowerCase()) {

          case "downtown":
            alert("Random Customers Generated Per Hour Open: " + downtown.ranCustArray);
            alert("Donuts sold per hour given an average of " + downtown.donutAverage + " donuts per customer: " + downtown.donutsHourArray);
            break;

          case "capitol hill":
            alert("Random Customers Generated Per Hour Open: " + capitolhill.ranCustArray);
            alert("Donuts sold per hour given an average of " + capitolhill.donutAverage + " donuts per customer: " + capitolhill.donutsHourArray);
            break;

          case "south lake union":
            alert("Random Customers Generated Per Hour Open: " + southlakeunion.ranCustArray);
            alert("Donuts sold per hour given an average of " + southlakeunion.donutAverage + " donuts per customer: " + southlakeunion.donutsHourArray);
            break;

          case "wedgewood":
            alert("Random Customers Generated Per Hour Open: " + wedgewood.ranCustArray);
            alert("Donuts sold per hour given an average of " + wedgewood.donutAverage + " donuts per customer: " + wedgewood.donutsHourArray);
            break;

          case "ballard":
            alert("Random Customers Generated Per Hour Open: " + ballard.ranCustArray);
            alert("Donuts sold per hour given an average of " + ballard.donutAverage + " donuts per customer: " + ballard.donutsHourArray);
            break;

          default:
            alert("Invalid name");
        }
      }

    </script>
  </body>
</html>
